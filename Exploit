<!DOCTYPE html>
<html lang="mn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B612-233 Final Exploit Tool</title>
    <!-- Tailwind CSS-–∏–π–≥ —Ç–∞—Ç–∞—Ö -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#0f172a', /* Slate 900 */
                        'card-bg': '#1e293b',    /* Slate 800 */
                        'accent-success': '#10b981', /* Emerald */
                        'accent-exploit': '#8b5cf6', /* Violet */
                        'accent-automation': '#0ea5e9', /* Sky Blue */
                        'text-light': '#f1f5f9', /* White */
                        'text-secondary': '#cbd5e1', /* Slate 300 */
                        'gemini-blue': '#4285F4', /* Google Blue */
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #f1f5f9; }
        .card { background-color: #1e293b; border-radius: 0.75rem; padding: 1.5rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -4px rgba(0, 0, 0, 0.1); }
        .phase-header { font-size: 1.5rem; font-weight: 700; color: #cbd5e1; border-bottom: 2px solid #334155; padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
        .automation-box { border: 2px solid #0ea5e9; padding: 1.5rem; border-radius: 0.5rem; background-color: #0d2c49; }
        .code-block { background-color: #0d121c; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; color: #4ade80; font-family: monospace; font-size: 0.875rem; white-space: pre-wrap; word-wrap: break-word; }
        .step-heading { font-weight: 600; color: #f97316; margin-top: 1rem; }
        .button-copy { padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: bold; margin-top: 0.5rem; }
        .alert-box { padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem; }
        .gemini-box { border: 2px solid #4285F4; background-color: #1c2b42; }
    </style>
</head>
<body class="p-4 md:p-8">

    <header class="text-center mb-10">
        <h1 class="text-3xl md:text-5xl font-extrabold text-accent-automation tracking-wider">
            B612-233 –î–ê–•–ò–ù –ò–ù–ñ–ï–ù–ï–†–ß–õ–≠–õ–ò–ô–ù –ë–ê–ì–ê–ñ
        </h1>
        <p class="text-xl mt-2 text-text-secondary">–ó”©–≤—Ö”©–Ω –ì–∞—Ä –£—Ç–∞—Å–Ω—ã –•”©—Ç”©—á”©”©—Ä Exploit –•–∏–π—Ö</p>
    </header>

    <!-- –ß–£–•–ê–õ –ê–ù–•–ê–ê–†–£–£–õ–ì–ê & –ê–õ–•–ú–£–£–î -->
    <div class="alert-box bg-yellow-900/50 border border-yellow-500/50 text-yellow-300">
        <h2 class="font-bold text-lg mb-2">üö® –ê–ù–•–ê–ê–†–£–£–õ–ì–ê: –ê–∂–∏–ª–ª—É—É–ª–∞—Ö—ã–Ω ”®–º–Ω”©</h2>
        <ol class="list-decimal list-inside ml-4 text-sm space-y-1">
            <li>**Unitel SIM-—ç—ç** —Ö–∏–π–≥—ç—ç—Å—Ç—ç–π, –∏–Ω—Ç–µ—Ä–Ω—ç—Ç —Å“Ø–ª–∂—ç—ç –∞–∂–∏–ª–ª–∞–∂ –±–∞–π—Ö —ë—Å—Ç–æ–π.</li>
            <li>–¢–∞ `192.168.8.1/html/index.html`-–¥ **`user1705`**-–∞–∞—Ä –Ω—ç–≤—Ç—ç—Ä—Å—ç–Ω –±–∞–π—Ö —ë—Å—Ç–æ–π.</li>
            <li>–¢–∞ –¥–æ–æ—Ä—Ö **2 Bookmarklet-–∏–π–≥** –¥–∞—Ä–∞–∞–ª–ª—ã–Ω –¥–∞–≥—É—É (–ê –¥–∞—Ä–∞–∞ –Ω—å –í) –∞–∂–∏–ª–ª—É—É–ª–Ω–∞.</li>
        </ol>
    </div>

    <!-- –ê–í–¢–û–ú–ê–¢–ñ–£–£–õ–ê–õ–¢–´–ù –ê–†–ì–ê–ß–õ–ê–õ -->
    <div class="card mb-8 automation-box">
        <h2 class="phase-header text-accent-automation border-gray-600">“Æ–ï –®–ê–¢ 2: –ê–í–¢–û–ú–ê–¢–ñ–£–£–õ–ê–õ–¢–´–ù –ö–û–î–£–£–î (BOOKMARKLET)</h2>
        <p class="text-text-secondary mb-6 font-bold">–¢–∞–Ω—ã —Ö–∏–π—Ö “Ø–π–ª–¥—ç–ª: –ö–æ–¥—ã–≥ —Ö—É—É–ª–∂ –∞–≤–∞–∞–¥, –≥–∞—Ä —É—Ç–∞—Å–Ω—ã —Ö”©—Ç”©—á–∏–π–Ω **Bookmark (URL)** —Ö—ç—Å—ç–≥—Ç –æ—Ä—É—É–ª–Ω–∞.</p>
        
        <ol class="list-decimal list-inside space-y-6">
            <li class="font-bold text-lg text-white">**BOOKMARKLET –ê: SUPER ADMIN –≠–†–• –ù–≠–≠–• (FORM SUBMISSION)**</li>
            <p class="ml-5 text-text-secondary">Chrome-–∏–π–Ω —Ö—è–∑–≥–∞–∞—Ä–ª–∞–ª—Ç—ã–≥ –¥–∞–≤–∞—Ö—ã–Ω —Ç—É–ª–¥ HTML Form –∞—à–∏–≥–ª–∞–∂, `telecomadmin/admin` —ç—Ä—Ö–∏–π–≥ –Ω—ç—ç–Ω—ç.</p>
            <p class="step-heading">1. –ö–æ–¥—ã–≥ –•—É—É–ª–∂ –ê–≤–∞—Ö:</p>
            <div class="code-block" id="exploitACode">
                javascript:(function(){var X=`<form id="eF" action="/api/system/account-unlock" method="POST" style="display:none;"><input name="request" value='&lt;request&gt;&lt;username&gt;telecomadmin&gt;/username&lt;password&gt;admin&lt;/password&gt;&lt;/request&gt;'></form>`;var D=document.createElement('div');D.innerHTML=X;document.body.appendChild(D);document.getElementById('eF').submit();alert('Exploit A - Form Submission: –ò–ª–≥—ç—ç–≥–¥–ª—ç—ç. –•—ç—Ä—ç–≤ OK –≥–∞—Ä—á –∏—Ä–≤—ç–ª Super Admin –Ω—ç—ç–≥–¥—Å—ç–Ω.');})();
            </div>
            <button onclick="copyCode('exploitACode')" class="button-copy bg-accent-exploit hover:bg-purple-700 text-white">BOOKMARKLET –ê-–≥ –•—É—É–ª–∞—Ö</button>
            <p class="step-heading">2. –ê–∂–∏–ª–ª—É—É–ª–∞—Ö:</p>
            <p class="ml-5 text-text-secondary">Bookmark-–∞–∞ –¥–∞—Ä–∞—Ö–∞–¥ **Alert** –≥–∞—Ä—á –∏—Ä–Ω—ç. –•—ç—Ä—ç–≤ OK –±–∞–π–≤–∞–ª –¥–∞—Ä–∞–∞–≥–∏–π–Ω –∞–ª—Ö–∞–º —Ä—É—É —à–∏–ª–∂–∏–Ω—ç. **(–•”©—Ç”©—á –¥–∞—Ö–∏–Ω –∞—á–∞–∞–ª–∂ –±–æ–ª–Ω–æ)**</p>
            
            
            <li class="font-bold text-lg text-white">**BOOKMARKLET B: SIM UNLOCK & TTL ”®”®–†–ß–õ”®–• (API CALL)**</li>
            <p class="ml-5 text-text-secondary">**–ß–£–•–ê–õ:** Exploit –ê –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–æ–ª–∂, Super Admin –Ω—ç—ç–≥–¥—Å—ç–Ω–∏–π –¥–∞—Ä–∞–∞ —ç–Ω—ç –∫–æ–¥—ã–≥ –∞–∂–∏–ª–ª—É—É–ª–Ω–∞.</p>
            <p class="step-heading">1. –ö–æ–¥—ã–≥ –•—É—É–ª–∂ –ê–≤–∞—Ö:</p>
            <div class="code-block" id="exploitBCode">
                javascript:(function(){function G(u,cb){var x=new XMLHttpRequest();x.onreadystatechange=function(){if(x.readyState==4&&x.status==200){cb(x.responseText);}};x.open("GET",u,true);x.send();}G("/api/webserver/token",function(t){var token=(t.match(/<token>(.*?)<\/token>/)||[0,'0'])[1];if(token==='0'){alert('–ê–ª–¥–∞–∞: Token –æ–ª–¥—Å–æ–Ω–≥“Ø–π.');return;}var success=0;var simLockXML=`<request><sim_lock>0</sim_lock></request>`;var ttlXML=`<request><ipv4_ttl>64</ipv4_ttl></request>`;fetch('/api/dialup/sim-lock',{method:'POST',headers:{'Content-Type':'application/xml','__RequestVerificationToken':token},body:simLockXML}).then(r=>r.text()).then(d=>{if(d.includes('OK')){success++;}return 'SIM Lock Unlocked';}).catch(e=>{console.error('SIM Lock Error:',e);return 'SIM Lock Error';});fetch('/api/net/ipv4-config',{method:'POST',headers:{'Content-Type':'application/xml','__RequestVerificationToken':token},body:ttlXML}).then(r=>r.text()).then(d=>{if(d.includes('OK')){success++;}return 'TTL Set to 64';}).catch(e=>{console.error('TTL Error:',e);return 'TTL Error';});if(success>=1){alert('–ê–ú–ñ–ò–õ–¢–¢–ê–ô! 2. –¢–æ—Ö–∏—Ä–≥–æ–æ ”©”©—Ä—á–ª”©–≥–¥–ª”©”© (SIM Lock:0, TTL:64). –¢—ç–º—Ü—ç—ç–Ω –î—É—É—Å–ª–∞–∞!');}else{alert('–¢–æ—Ö–∏—Ä–≥–æ–æ–≥ ”©”©—Ä—á–ª”©—Ö “Ø–µ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞. Super Admin-—ç—ç—Ä –Ω—ç–≤—Ç—ç—Ä—á –≥–∞—Ä–∞–∞—Ä —à–∞–ª–≥–∞–Ω–∞ —É—É: telecomadmin/admin');}}).catch(e=>{alert('Exploit B –ù–∏–π—Ç –∞–ª–¥–∞–∞: '+e.message);});});})();
            </div>
            <button onclick="copyCode('exploitBCode')" class="button-copy bg-accent-automation hover:bg-sky-700 text-white">BOOKMARKLET –í-–≥ –•—É—É–ª–∞—Ö</button>
            <p class="step-heading">2. –ê–∂–∏–ª–ª—É—É–ª–∞—Ö:</p>
            <p class="ml-5 text-text-secondary">Exploit A-–≥ –∞–º–∂–∏–ª—Ç—Ç–∞–π –∞–∂–∏–ª–ª—É—É–ª—Å–Ω—ã –¥–∞—Ä–∞–∞ —à—É—É–¥ —ç–Ω—ç Bookmarklet-–∏–π–≥ –¥–∞—Ä–∂, **SIM Lock** –±–æ–ª–æ–Ω **TTL**-–∏–π–≥ ”©”©—Ä—á–∏–ª–Ω”©.</p>
            
            <li class="font-bold text-lg text-white mt-6">**“Æ–† –î“Æ–ù:**</li>
            <p class="ml-5 text-accent-success font-bold">Exploit B –∞–º–∂–∏–ª—Ç—Ç–∞–π –±–æ–ª—Å–Ω—ã –¥–∞—Ä–∞–∞ —Ç–∞ —Ä–æ—É—Ç–µ—Ä—Ç—ç—ç `telecomadmin`/`admin`-—ç—ç—Ä –Ω—ç–≤—Ç—ç—Ä—á, SIM Lock –±–æ–ª–æ–Ω TTL-–∏–π–≥ —à–∞–ª–≥–∞–Ω–∞ —É—É.</p>
        </ol>
    </div>

    <!-- –ì–ï–ú–ò–ù–ê–ô–ù –ó”®–í–õ”®–• –•–≠–°–≠–ì (GEMINI API INTEGRATION) -->
    <div class="card mb-8 gemini-box">
        <h2 class="phase-header text-gemini-blue border-gray-600 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 text-gemini-blue"><path d="M12 2L12 22M2 12L22 12M17 5L7 19M7 5L17 19"/></svg>
            TTL/–°“Ø–ª–∂—ç—ç–Ω–∏–π –¢–æ—Ö–∏—Ä–≥–æ–æ–Ω—ã –ó”©–≤–ª”©—Ö ‚ú®
        </h2>
        <p class="text-text-secondary mb-4">Huawei —Ä–æ—É—Ç–µ—Ä, TTL, Band Lock –∑—ç—Ä—ç–≥ —Å“Ø–ª–∂—ç—ç–Ω–∏–π –Ω–∞—Ä–∏–π–Ω —Ç–æ—Ö–∏—Ä–≥–æ–æ—Ç–æ–π —Ö–æ–ª–±–æ–æ—Ç–æ–π –∞—Å—É—É–ª—Ç –∞—Å—É—É–∂, –º—ç—Ä–≥—ç–∂–∏–ª—Ç–Ω–∏–π –∑”©–≤–ª”©–≥”©”© –∞–≤–∞–∞—Ä–∞–π. (–ñ–∏—à—ç—ç: "TTL-–∏–π–≥ 64 –±–æ–ª–≥–æ—Ö—ã–Ω –∞—á —Ö–æ–ª–±–æ–≥–¥–æ–ª —é—É –≤—ç?")</p>
        
        <textarea id="advisorQuery" class="w-full h-24 p-3 mb-3 rounded-lg bg-gray-700 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-gemini-blue" placeholder="–ê—Å—É—É–ª—Ç–∞–∞ —ç–Ω–¥ –±–∏—á–Ω—ç “Ø“Ø..."></textarea>
        
        <button id="askAdvisorBtn" onclick="askAdvisor()" class="w-full button-copy bg-gemini-blue hover:bg-blue-600 text-white transition duration-150">
            –ó”©–≤–ª”©—Ö”©”©—Å –ê—Å—É—É—Ö
        </button>
        
        <div id="advisorLoading" class="hidden text-center mt-4 text-gemini-blue font-bold">
            <div class="animate-spin inline-block w-6 h-6 border-[3px] border-current border-t-transparent rounded-full" role="status"></div>
            –ú—ç—Ä–≥—ç–∂–∏–ª—Ç—ç–Ω –∑”©–≤–ª”©–≥”©”© –±—ç–ª–¥—ç–∂ –±–∞–π–Ω–∞...
        </div>
        
        <div id="advisorResult" class="mt-4 p-4 rounded-lg bg-gray-700/50 text-text-light hidden">
            <h3 class="font-bold border-b border-gray-600 pb-2 mb-2">–•–∞—Ä–∏—É–ª—Ç:</h3>
            <div id="resultText" class="text-sm space-y-3"></div>
            <div id="sourcesArea" class="mt-3 pt-2 border-t border-gray-600 text-xs text-gray-400"></div>
        </div>
    </div>


    <footer class="text-center mt-10 p-4 border-t border-gray-700">
        <h3 class="text-2xl font-bold text-accent-success">–ë–∏–¥ —ç–Ω—ç —Ç—ç–º—Ü—ç—ç–Ω–∏–π–≥ —è–ª–∞—Ö –±–æ–ª–Ω–æ!</h3>
    </footer>

    <script>
        // –ö–æ–¥—ã–≥ —Ö—É—É–ª–∞—Ö —Ñ—É–Ω–∫—Ü
        function copyCode(id) {
            const codeBlock = document.getElementById(id);
            const codeToCopy = codeBlock.textContent.trim();
            
            // –•—É—É–ª–∞—Ö “Ø–π–ª–¥–ª–∏–π–≥ navigator.clipboard-—ç—ç—Ä —Ö–∏–π—Ö
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(codeToCopy).then(() => {
                    alert(`"${id}" –∫–æ–¥—ã–Ω –º”©—Ä–∏–π–≥ –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ö—É—É–ª–ª–∞–∞. –û–¥–æ–æ –≥–∞—Ä —É—Ç–∞—Å–Ω—ã—Ö–∞–∞ Bookmark-–∏–π–Ω URL —Ö—ç—Å—ç–≥—Ç –æ—Ä—É—É–ª–∞–∞—Ä–∞–π.`);
                }).catch(err => {
                    fallbackCopy(codeToCopy);
                });
            } else {
                fallbackCopy(codeToCopy);
            }
        }

        function fallbackCopy(text) {
             // –•—É—É–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π —Ç–æ—Ö–∏–æ–ª–¥–æ–ª–¥
             const textarea = document.createElement('textarea');
             textarea.value = text;
             textarea.style.position = 'fixed';
             textarea.style.left = '-9999px';
             document.body.appendChild(textarea);
             textarea.focus();
             textarea.select();
             try {
                document.execCommand('copy');
                alert('–ö–æ–¥ –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ö—É—É–ª–∞–≥–¥–ª–∞–∞! –û–¥–æ–æ Bookmark-–∏–π–Ω URL —Ö—ç—Å—ç–≥—Ç –æ—Ä—É—É–ª–∞–∞—Ä–∞–π.');
             } catch (err) {
                alert('–ö–æ–¥—ã–≥ —Ö—É—É–ª–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π –±–∞–π–Ω–∞. –î—ç—ç—Ä—Ö –∫–æ–¥—ã–≥ –≥–∞—Ä–∞–∞—Ä —Ö—É—É–ª–∂ –∞–≤–∞–∞–¥ Bookmark-–∏–π–Ω URL —Ö—ç—Å—ç–≥—Ç –æ—Ä—É—É–ª–∞–∞—Ä–∞–π.');
             }
             document.body.removeChild(textarea);
        }

        // ==========================================================
        // –ì–ï–ú–ò–ù–ê–ô–ù –ó”®–í–õ”®–• (GEMINI API) –õ–û–ì–ò–ö
        // ==========================================================
        
        const apiKey = ""; // Canvas will automatically provide the key
        const apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent";
        const maxRetries = 5;

        async function callGeminiApi(payload) {
            let lastError = null;
            for (let attempt = 0; attempt < maxRetries; attempt++) {
                try {
                    const response = await fetch(`${apiUrl}?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    return await response.json();

                } catch (error) {
                    lastError = error;
                    // Exponential backoff
                    const delay = Math.pow(2, attempt) * 1000 + Math.random() * 1000;
                    if (attempt < maxRetries - 1) {
                        await new Promise(resolve => setTimeout(resolve, delay));
                    }
                }
            }
            throw new Error(`Failed to fetch from Gemini API after ${maxRetries} attempts: ${lastError ? lastError.message : 'Unknown error'}`);
        }

        async function askAdvisor() {
            const queryInput = document.getElementById('advisorQuery');
            const resultDiv = document.getElementById('advisorResult');
            const resultText = document.getElementById('resultText');
            const sourcesArea = document.getElementById('sourcesArea');
            const loadingIndicator = document.getElementById('advisorLoading');
            const askButton = document.getElementById('askAdvisorBtn');

            const userQuery = queryInput.value.trim();
            if (!userQuery) {
                alert('–ê—Å—É—É–ª—Ç –æ—Ä—É—É–ª–Ω–∞ —É—É.');
                return;
            }

            // UI State: Loading
            resultDiv.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');
            askButton.disabled = true;
            resultText.innerHTML = '';
            sourcesArea.innerHTML = '';


            try {
                const systemPrompt = "Act as a highly experienced Network Security Engineer and Telecommunications Expert specializing in Huawei router configuration and mobile broadband limitations (like TTL, SIM Lock, and firmware exploitation). Provide accurate, concise, and technical advice based on the user's query. Use Mongolian language for the response.";
                
                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    tools: [{ "google_search": {} }], // Use Google Search for grounding
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                const result = await callGeminiApi(payload);
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    // 1. Extract generated text
                    const text = candidate.content.parts[0].text;
                    resultText.innerHTML = text.replace(/\n/g, '<br>');

                    // 2. Extract grounding sources
                    let sources = [];
                    const groundingMetadata = candidate.groundingMetadata;
                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        sources = groundingMetadata.groundingAttributions
                            .map(attribution => ({
                                uri: attribution.web?.uri,
                                title: attribution.web?.title,
                            }))
                            .filter(source => source.uri && source.title);
                    }

                    // 3. Display sources
                    if (sources.length > 0) {
                        const uniqueSources = sources.reduce((map, obj) => {
                            map[obj.uri] = obj.title;
                            return map;
                        }, {});

                        let sourcesHtml = '–≠—Ö —Å—É—Ä–≤–∞–ª–∂—É—É–¥: ';
                        let count = 1;
                        for (const uri in uniqueSources) {
                            sourcesHtml += `<a href="${uri}" target="_blank" class="text-blue-400 hover:text-blue-300"> [${count}]${uniqueSources[uri]}</a>; `;
                            count++;
                        }
                        sourcesArea.innerHTML = sourcesHtml;
                    } else {
                        sourcesArea.innerHTML = '–ù—ç–º—ç–ª—Ç —ç—Ö —Å—É—Ä–≤–∞–ª–∂ –æ–ª–¥—Å–æ–Ω–≥“Ø–π.';
                    }
                } else {
                    resultText.innerHTML = '–•–∞—Ä–∏—É–ª—Ç –∞–≤–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π: –ú–æ–¥–µ–ª–∏–π–Ω —Ö–∞—Ä–∏—É–ª—Ç—ã–Ω –±“Ø—Ç—ç—Ü –±—É—Ä—É—É –±–∞–π–Ω–∞.';
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                resultText.innerHTML = `<span class="text-red-400">–ê–ª–¥–∞–∞: Gemini API –¥—É—É–¥–ª–∞–≥–∞ –∞–º–∂–∏–ª—Ç–≥“Ø–π –±–æ–ª–ª–æ–æ. ${error.message}</span>`;
            } finally {
                // UI State: Complete
                loadingIndicator.classList.add('hidden');
                resultDiv.classList.remove('hidden');
                askButton.disabled = false;
            }
        }
    </script>
</body>
</html>
